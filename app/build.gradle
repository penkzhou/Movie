plugins {
    id 'com.android.application'
    id 'org.gradle.android.cache-fix' version '3.0.1'
    id 'kotlin-android'
    id 'kotlin-parcelize'
    id 'com.google.gms.google-services'
    id 'com.google.firebase.crashlytics'
    id 'com.google.firebase.firebase-perf'
    id 'dagger.hilt.android.plugin'
    id 'com.google.devtools.ksp'
    id("com.diffplug.spotless") version "6.25.0"
}

android {
    compileSdk 34

    defaultConfig {
        applicationId "com.oldautumn.movie"
        minSdk 22
        targetSdk 34
        versionCode 2
        versionName "0.0.1"

        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
    }

    buildTypes {
        release {
            minifyEnabled true
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_17
        targetCompatibility JavaVersion.VERSION_17
    }
    kotlinOptions {
        jvmTarget = '17'
    }


    kotlin {
        jvmToolchain(17)
    }    
    
    buildFeatures {
        viewBinding true
        buildConfig true
    }
    namespace 'com.oldautumn.movie'

    testOptions {
        unitTests.returnDefaultValues = true
    }

}

dependencies {


    // ViewModel
    implementation libs.lifecycle.viewmodel.ktx
    implementation libs.lifecycle.livedata.ktx
    implementation libs.lifecycle.runtime.ktx
    implementation libs.lifecycle.viewmodel.savedstate

    implementation libs.constraintlayout
    implementation libs.datastore
    implementation libs.navigation.fragment.ktx
    implementation libs.navigation.ui.ktx
    implementation libs.androidx.core

    implementation libs.appCompat
    implementation libs.fragment
    implementation libs.preference
    implementation libs.paging
    implementation libs.palette
    implementation libs.material

    implementation libs.hiltdagger
    ksp libs.hiltdagger.compiler

    implementation libs.dotsindicator
    implementation libs.retrofit2.converter.moshi
    implementation libs.okhttp.logging.interceptor

    implementation platform(libs.deps.firebase.bom)
    implementation libs.deps.firebase.crashlytics
    implementation libs.deps.firebase.analytics
    implementation libs.deps.firebase.perf

    implementation libs.coil

    testImplementation libs.junit
    androidTestImplementation libs.androidxTest
    androidTestImplementation libs.androidxEspresso
}

spotless { // if you are using build.gradle.kts, instead of 'spotless {' use:
    // configure<com.diffplug.gradle.spotless.SpotlessExtension> {
    kotlin {
        // by default the target is every '.kt' and '.kts` file in the java sourcesets

        target("src/**/*.kt")
        ktlint("1.2.1")   // has its own section below
        licenseHeaderFile(rootProject.file("spotless/Copyright.kt"))
    }
    kotlinGradle {
        target("*.kts")
        ktlint("1.2.1")
        licenseHeaderFile(rootProject.file("spotless/Copyright.kts"), "(^(?![\\/ ]\\**).*\$)")
    }
}

